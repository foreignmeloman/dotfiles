plugins:
  tmux-shell:
    shortCut: x
    description: "tmux horizontal split shell"
    scopes:
    - po
    command: tmux
    background: false
    args:
    - split-window
    - -v
    - bash
    - -c
    - >-
      kubectl --context=$CONTEXT --namespace=$NAMESPACE exec -it $NAME -- /bin/sh 2> /dev/null ||
      kubectl --context=$CONTEXT --namespace=$NAMESPACE exec -it $NAME -- /bin/bash 2> /dev/null ||
      kubectl --context=$CONTEXT --namespace=$NAMESPACE exec -it $NAME -- /bin/ash
  tmux-shell-container:
    shortCut: x
    description: "tmux horizontal split shell"
    scopes:
    - containers
    command: tmux
    background: false
    args:
    - split-window
    - -v
    - bash
    - -c
    - >-
      kubectl --context=$CONTEXT --namespace=$NAMESPACE exec -it --container=$NAME $POD -- /bin/sh 2> /dev/null ||
      kubectl --context=$CONTEXT --namespace=$NAMESPACE exec -it --container=$NAME $POD -- /bin/bash 2> /dev/null ||
      kubectl --context=$CONTEXT --namespace=$NAMESPACE exec -it --container=$NAME $POD -- /bin/ash
  external-secret-refresh:
    shortCut: r
    description: "Annotate extenal secret to be refreshed immideately"
    scopes:
    - externalsecrets
    command: bash
    background: true
    confirm: true
    args:
    - -c
    - kubectl --context=$CONTEXT --namespace=$NAMESPACE annotate $RESOURCE_NAME $NAME force-sync=$(date +%s) --overwrite
  cluster-external-secret-refresh:
    shortCut: r
    description: "Annotate cluster extenal secret to be refreshed immideately"
    scopes:
    - clusterexternalsecrets
    command: bash
    background: true
    confirm: true
    args:
    - -c
    - kubectl --context=$CONTEXT annotate $RESOURCE_NAME $NAME external-secrets.io/force-sync=$(date +%s) --overwrite
  gonzo:
    shortCut: Ctrl-L
    description: "Gonzo log analysis"
    scopes:
      - po
    command: sh
    background: false
    args:
      - -c
      - "kubectl logs -f --tail=0 $NAME -n $NAMESPACE --context $CONTEXT | gonzo"
  gonzo-container:
    shortCut: Ctrl-L
    description: "Gonzo log analysis"
    scopes:
      - containers
    command: sh
    background: false
    args:
      - -c
      - "kubectl logs -f --tail=0 --container=$NAME $POD -n $NAMESPACE --context $CONTEXT | gonzo"
  log-less:
    shortCut: Shift-L
    description: "logs|less"
    scopes:
    - po
    command: bash
    background: false
    args:
    - -c
    - '"$@" | less'
    - dummy-arg
    - kubectl
    - logs
    - $NAME
    - -n
    - $NAMESPACE
    - --context
    - $CONTEXT
    - --kubeconfig
    - $KUBECONFIG
  log-less-container:
    shortCut: Shift-L
    description: "logs|less"
    scopes:
    - containers
    command: bash
    background: false
    args:
    - -c
    - '"$@" | less'
    - dummy-arg
    - kubectl
    - logs
    - -c
    - $NAME
    - $POD
    - -n
    - $NAMESPACE
    - --context
    - $CONTEXT
    - --kubeconfig
    - $KUBECONFIG
  log-bat:
    shortCut: b
    description: "logs|bat"
    scopes:
    - po
    command: bash
    background: false
    args:
    - -c
    - '"$@" | bat -l=log'
    - dummy-arg
    - kubectl
    - logs
    - $NAME
    - -n
    - $NAMESPACE
    - --context
    - $CONTEXT
    - --kubeconfig
    - $KUBECONFIG
  log-bat-container:
    shortCut: b
    description: "logs|bat"
    scopes:
    - containers
    command: bash
    background: false
    args:
    - -c
    - '"$@" | bat -l=log'
    - dummy-arg
    - kubectl
    - logs
    - -c
    - $NAME
    - $POD
    - -n
    - $NAMESPACE
    - --context
    - $CONTEXT
    - --kubeconfig
    - $KUBECONFIG
